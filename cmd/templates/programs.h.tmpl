// Code generated by ouroboros. DO NOT EDIT.
// This file is automatically generated by the ouroboros tool.

#ifndef __PROGRAMS_H
#define __PROGRAMS_H

#include <linux/bpf.h>
#include <bpf/bpf_helpers.h>

#define PROG_MAP_NAME {{.ProgramMap}}
#define PROG_MAX_ENTRIES 65535

struct {
    __uint(type, BPF_MAP_TYPE_PROG_ARRAY);
    __uint(max_entries, PROG_MAX_ENTRIES);
    __type(key, __u32);
    __type(value, __u32);
    __uint(pinning, LIBBPF_PIN_BY_NAME);
} PROG_MAP_NAME SEC(".maps");

#define __STRINGIFY(x) #x

#define JUMP_TO_PROGRAM(ctx, idx) \
    bpf_tail_call(ctx, &PROG_MAP_NAME, idx); \
    bpf_printk("Jumping to program " #idx " FAILED! Check if map is correctly configured! If else, CALL GGWALLEX!!!! Falling back to XDP_PASS!!! Occured @ " __FILE__ ":" __STRINGIFY(__LINE__)); \
    return XDP_PASS;


// Programs
{{range .Programs}}#define PROG_{{.Name}} {{.ID}}
{{end}}

#endif // __PROGRAMS_H

